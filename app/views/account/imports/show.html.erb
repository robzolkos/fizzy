<% @page_title = "Import status" %>

<%= turbo_stream_from @import %>

<div class="panel panel--centered flex flex-column gap-half">
  <h1 class="txt-x-large font-weight-black margin-block-end">Import status</h1>

  <% case @import.status %>
  <% when "pending", "processing" %>
    <p class="txt-medium">Your import is in progress. This may take a while for large accounts.</p>
  <% when "completed" %>
    <p class="txt-medium txt-positive">Your import has completed successfully!</p>
    <%= link_to "Go to your account", landing_url(script_name: @import.account.slug), class: "btn btn--link center txt-medium" %>
  <% when "failed" %>
    <p class="txt-medium txt-negative">Your import failed.</p>
    <% if @import.failed_due_to_conflict? %>
      <p class="txt-small">It looks like the account you are trying to import already exists.</p>
    <% elsif @import.failed_due_to_invalid_export? %>
      <p class="txt-small">The ZIP file isn't a Fizzy account export.</p>
    <% else %>
      <p class="txt-small">This may be due to corrupted export data or a conflict with existing data. Please try again with a fresh export.</p>
    <% end %>
    <%= link_to "Try again", new_account_import_path, class: "btn btn--plain center txt-medium" %>
  <% end %>
</div>

<% content_for :footer do %>
  <%= render "sessions/footer" %>
<% end %>
